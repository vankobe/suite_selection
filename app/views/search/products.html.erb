<%= stylesheet_link_tag "products"%>
<link href='http://fonts.googleapis.com/css?family=Meddon|Lemon|Miltonian|Salsa' rel='stylesheet' type='text/css'>
<div id="title">
  <h2>
    Sweeta
  </h2>
</div>
<%= render :partial => 'search_box' %>
<%-
 params.delete(:score_order)
 params.delete(:updated_order)
-%>
<div id="main">
  <div id="search_result">
    <ul>
      <% if @category_name.present? || @type_name.present? || @flavor_name.present? || @shop_name.present? %>
        <%- if @type_name -%>
          <li class="type word"><%= @type_name%></li>
        <%- elsif @category_name -%>
          <li class="category word"><%= @category_name%></li>
        <%- end -%>
        <%- if @flavor_name -%>
          <li class="flavor word"><%= @flavor_name%></li>
        <%- end -%>
        <%- if @shop_name -%>
          <li class="shop word"><%= @shop_name%></li>
        <%- end -%>
      <%- else -%>
        <li>全件</li>
      <%- end -%>
      <li>の検索結果 (<%= @product_count %> 件)</li>
      <li><%= button_to t ".clear_search", controller: :search, action: :products%></li>
    </ul>
  </div>
  <div id="order_box" class="btn-group">
    <span class="btn"><%= link_to t("order.score"), params.merge({:order => "score"})%></span>
    <span class="btn"><%= link_to t("order.created_at"), params.merge({:order => "updated"})%></span>
  </div>
  <div id="search-result-list">
  <%= paginate @products%>
  <%- unless @products.present?-%>
    <p>検索結果がありません</p>
  <%- else # 検索結果表示-%>
    <%- @products.each do |product| -%>
      <div class="product_list_each">
        <h3><%=link_to product.name, {:controller => :products, :action => :show, :id => product.id} %>
          <%- if product.try(:score) -%><span>(<%= product.try(:score) %>)</span><%- end -%>
        </h3>
        <div class="product_list_image">
          <%= product_thum_path(product, 250)%>
        </div>
        <div class="product_list_info">
          <dl>
            <dt>ショップ名</dt>
            <dd><%= product.shop.name%></dd>
            <dt>最安値</dt>
            <dd><%= humanized_money_with_symbol product.providers.first.price.exchange_to(@currency_code)%></dd>
            <dt>内容量</dt>
            <%- product.contents.each do |product_content|-%>
              <dd><%= product_content_list(product_content)%></dd>
            <%- end -%>
          </dl>
        </div>
      </div>
    <%- end -%>
  <%- end -%>
  <%= paginate @products%>
  </div>
</div>
